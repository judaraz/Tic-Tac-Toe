<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tasks ‚Äî Telegram Mini App</title>
  <!-- Telegram Web App JS -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root{--accent:#ffb000;--bg:#0f0f10;--card:#131313;--muted:#9b9b9b;--white:#ffffff}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(0deg, #fff 0%, #fff 0%);display:flex;align-items:center;justify-content:center;padding:18px}
    .frame{width:380px;border-radius:20px;padding:0;background:#ffb000;box-shadow:0 6px 0 rgba(0,0,0,0.06)}
    .device{background:var(--bg);border-radius:14px;padding:0 0 22px;overflow:hidden}
    header{height:86px;padding:18px 18px 12px;color:var(--white);display:flex;flex-direction:column}
    header .top{display:flex;align-items:center;justify-content:space-between}
    header h1{margin:0;font-size:20px;font-weight:600}
    .subtitle{opacity:0.6;font-size:13px}
    main{padding:18px}
    .section-title{color:var(--white);font-size:34px;margin:6px 0 8px}
    .section-sub{color:var(--muted);font-size:14px;margin-bottom:12px}
    .card{background:linear-gradient(0deg,#ffb000 0%, #ffb000 0%);display:flex;align-items:center;justify-content:space-between;padding:16px;border-radius:8px;margin-bottom:14px}
    .card.dark{background:var(--card)}
    .left{display:flex;align-items:center;gap:14px}
    .emoji{font-size:42px}
    .text{color:var(--white)}
    .title{font-size:18px;margin:0}
    .meta{font-size:12px;color:rgba(255,255,255,0.85);opacity:0.9}
    .btn{background:var(--white);color:var(--bg);padding:8px 14px;border-radius:22px;font-weight:600;border:none;cursor:pointer}
    .muted-card{background:var(--card);padding:18px;border-radius:8px;color:var(--white)}
    .small-row{display:flex;align-items:center;justify-content:space-between;margin-top:12px}
    .clock-badge{width:40px;height:40px;border-radius:50%;background:linear-gradient(180deg,#2b2b2b,#181818);display:flex;align-items:center;justify-content:center;color:#fff}
    footer{height:8px}
    /* responsive smaller */
    @media(max-width:420px){.frame{width:360px}}
  </style>
</head>
<body>
  <div class="frame" role="application">
    <div class="device">
      <header>
        <div class="top">
          <div style="opacity:0.95">Close</div>
          <h1>Your app</h1>
          <div style="opacity:0.6">‚ãØ</div>
        </div>
        <div style="margin-top:8px">
          <div class="section-title">Tasks</div>
          <div class="subtitle">Get rewards for actions</div>
        </div>
      </header>

      <main>
        <!-- Rewarded Interstitial (orange) -->
        <div class="card" id="rewarded-interstitial">
          <div class="left">
            <div class="emoji">ü§©</div>
            <div>
              <p class="title">Watch short ads</p>
              <div class="meta">Rewarded Interstitial</div>
            </div>
          </div>
          <div>
            <button class="btn" id="btn-rewarded-interstitial">Claim</button>
          </div>
        </div>

        <!-- Rewarded Popup (dark) -->
        <div class="card dark" id="rewarded-popup" style="margin-bottom:18px">
          <div class="left">
            <div class="emoji">üòé</div>
            <div>
              <p class="title">Click to get reward</p>
              <div class="meta">Rewarded Popup</div>
            </div>
          </div>
          <div>
            <button class="btn" id="btn-rewarded-popup">Claim</button>
          </div>
        </div>

        <div class="muted-card">
          <div style="font-size:22px;margin-bottom:6px">Daily</div>
          <div style="color:var(--muted);font-size:13px;margin-bottom:14px">After time actions</div>

          <div class="small-row">
            <div style="display:flex;align-items:center;gap:14px">
              <div class="emoji" style="font-size:36px">üëÄ</div>
              <div>
                <div class="title">Watch video</div>
                <div class="meta">In-App Interstitial</div>
              </div>
            </div>
            <div style="display:flex;align-items:center;gap:8px">
              <div class="clock-badge">‚è±</div>
              <button class="btn" id="btn-inapp">Watch</button>
            </div>
          </div>
        </div>
      </main>
      <footer></footer>
    </div>
  </div>

  <script>
    // Telegram WebApp helper
    const tg = window.Telegram.WebApp || null;
    if (tg){
      tg.expand();
      // You can use tg.MainButton / tg.BackButton here if needed
    }

    // --- Ad SDK integration ---
    // NOTE: This file assumes the ad SDK exposes a global function `show_9730228` (as in your snippet).
    // If your ad provider requires an external script, load it first. Example:
    // const s = document.createElement('script'); s.src = 'https://cdn.adprovider.example/sdk.js'; document.head.appendChild(s);

    // Setup in-app interstitial automatic behavior on load
    function initInApp() {
      try{
        // call your in-app scheduler with the settings provided
        if (typeof show_9730228 === 'function'){
          show_9730228({
            type: 'inApp',
            inAppSettings: {
              frequency: 2,
              capping: 0.1,
              interval: 30,
              timeout: 5,
              everyPage: false
            }
          });
        } else {
          console.warn('show_9730228 is not defined. Make sure the ad SDK script is loaded.');
        }
      } catch(e){console.error('inApp init error', e)}
    }

    // Rewarded Popup
    async function showRewardedPopup(){
      if (typeof show_9730228 !== 'function'){
        alert('Ad SDK not loaded');
        return;
      }
      try{
        await show_9730228('pop');
        // Reward the user here
        rewardUser('popup');
      } catch(e){
        console.warn('Popup ad failed or was closed', e);
      }
    }

    // Rewarded Interstitial
    async function showRewardedInterstitial(){
      if (typeof show_9730228 !== 'function'){
        alert('Ad SDK not loaded');
        return;
      }
      try{
        await show_9730228();
        // Reward the user here
        rewardUser('interstitial');
      } catch(e){
        console.warn('Rewarded interstitial error', e);
      }
    }

    // Manual In-App ad trigger (if you want to force one)
    function triggerInAppNow(){
      if (typeof show_9730228 === 'function'){
        // Some providers allow calling with {type:'inApp', immediate:true} or similar.
        // Here we call the same function without params to show an interstitial if available.
        try{
          show_9730228({type:'inApp', inAppSettings:{frequency:1, capping:0.01, interval:0, timeout:0, everyPage:true}});
        }catch(e){console.warn(e)}
      }else{
        alert('Ad SDK not loaded');
      }
    }

    // Placeholder reward function
    function rewardUser(source){
      // Replace with your app logic (increment coins, unlock level, etc.)
      console.log('Rewarding user for', source);
      // show a Telegram main button message if available
      if (tg && tg.MainButton){
        tg.MainButton.setText('Reward granted üéâ');
        tg.MainButton.show();
        setTimeout(()=>tg.MainButton.hide(), 1800);
      } else {
        // fallback UI
        alert('You earned a reward!');
      }
    }

    // Wire up UI
    document.getElementById('btn-rewarded-popup').addEventListener('click', (e)=>{
      e.preventDefault();
      showRewardedPopup();
    });

    document.getElementById('btn-rewarded-interstitial').addEventListener('click', (e)=>{
      e.preventDefault();
      showRewardedInterstitial();
    });

    document.getElementById('btn-inapp').addEventListener('click', (e)=>{
      e.preventDefault();
      // attempt to trigger an in-app ad now
      triggerInAppNow();
    });

    // init
    window.addEventListener('load', ()=>{
      initInApp();
    });

    // Optional: Clean up on unload
    window.addEventListener('beforeunload', ()=>{
      try{ if (tg) tg.close(); }catch(e){}
    });
  </script>

  <!--
    Deployment notes:
    1. Host this file on HTTPS (Telegram requires secure origin).
    2. Ensure your ad provider's SDK is loaded before calling show_9730228. If they supply a script URL, add it above and initialize per their docs.
    3. In your Bot settings (BotFather) set the Web App URL to point to this hosted page.
    4. Test inside Telegram: open the bot and use ReplyKeyboardButton with web_app or inline button with WebApp.
  -->
</body>
</html>
